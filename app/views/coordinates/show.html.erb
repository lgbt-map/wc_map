<div class="alert alert-secondary" role="alert">
  <div class="alert alert-light" role="alert">
    <div class="text-center">
      <h3><strong style="color:dimgray"><%= @coordinate.name %></strong></h3>
      <%= attachment_image_tag @coordinate, :image, :fill, 200, 130, size: "200x130", fallback: "no_image.jpg", id: 'coord_img' %>
      <hr class="show-hr">
      <div class="row">
        <div class="col-sm-6 offset-3">
          <table class="table table-borderless">
            <tbody>
              <tr>
                <td style="color: #555555;">メモ：</td>
                <% if @coordinate.memo.nil? %>
                  <td>----------</td>
                <% else %>
                  <td><%= @coordinate.memo %></td>
                <% end %>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-10 offset-1 alert alert-secondary">
          <div class="row">
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">和式</strong>
                <hr class="show-hr">
                <% if @facility.toilet_jp %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">洋式</strong>
                <hr class="show-hr">
                <% if @facility.toilet_west %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">ウォシュレット</strong>
                <hr class="show-hr">
                <% if @facility.washlet %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">パウダールーム</strong>
                <hr class="show-hr">
                <% if @facility.powder_room %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">おむつ交換台設備</strong>
                <hr class="show-hr">
                <% if @facility.changing_table %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">オストメイト</strong>
                <hr class="show-hr">
                <% if @facility.ostomate %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">誰でもトイレ</strong>
                <hr class="show-hr">
                <% if @facility.can_everyone %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">男女別</strong>
                <hr class="show-hr">
                <% if @facility.gender_separation %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
            <div class="col-sm-4">
              <div class="alert alert-light">
                <strong style="color: #555555;">車いす対応</strong>
                <hr class="show-hr">
                <% if @facility.wheelchair %>
                  <i class="far fa-circle"></i>
                <% else %>
                  <br>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="text-center">
      <div class="row form-group">
        <div class="col-sm-4 offset-2">
          <h6>清潔感</h6>
        </div>
        <div class="col-sm-4">
          <i id="cleanliness1"></i>
          <i id="cleanliness2"></i>
          <i id="cleanliness3"></i>
          <i id="cleanliness4"></i>
          <i id="cleanliness5"></i>
        </div>
      </div>
      <div class="row form-group">
        <div class="col-sm-4 offset-2">
          <h6>広さ</h6>
        </div>
        <div class="col-sm-4">
          <i id="breadth1"></i>
          <i id="breadth2"></i>
          <i id="breadth3"></i>
          <i id="breadth4"></i>
          <i id="breadth5"></i>
        </div>
      </div>
      <div class="row form-group">
        <div class="col-sm-4 offset-2">
          <h6>高級感</h6>
        </div>
        <div class="col-sm-4">
          <i id="luxury1"></i>
          <i id="luxury2"></i>
          <i id="luxury3"></i>
          <i id="luxury4"></i>
          <i id="luxury5"></i>
        </div>
      </div>
      <div class="row form-group">
        <div class="col-sm-4 offset-2">
          <h6>人の出入り</h6>
        </div>
        <div class="col-sm-4">
          <i id="use_rate1"></i>
          <i id="use_rate2"></i>
          <i id="use_rate3"></i>
          <i id="use_rate4"></i>
          <i id="use_rate5"></i>
        </div>
      </div>
      <div class="row form-group">
        <div class="col-sm-4 offset-2">
          <h6>プライバシー保護</h6>
        </div>
        <div class="col-sm-4">
          <i id="security1"></i>
          <i id="security2"></i>
          <i id="security3"></i>
          <i id="security4"></i>
          <i id="security5"></i>
        </div>
      </div>
    </div>
    <div class="text-right">
      <div class="row form-group">
        <div class="col-sm-8 offset-3">
          <span><b>平均: <%= @total_average %>つ<b></span>
          <i id="ave1"></i>
          <i id="ave2"></i>
          <i id="ave3"></i>
          <i id="ave4"></i>
          <i id="ave5"></i>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-10 offset-1">
        <canvas id="myChart"></canvas>
      </div>
    </div>
    </div>
  </div>
</div>

<script>
  function drawStarEvaluation (baseId, score) {
    for(var i=1; i<=5; i++) {
      var idName = baseId + i;
      if (score >= 1) {
        var addClassName = "fas fa-star";
      } else if (score > 0) {
        var addClassName = "fas fa-star-half-alt";
      } else {
        var addClassName = "far fa-star";
      }
      score -= 1;
      $(document.getElementById(idName)).addClass(addClassName);
    }
  }
  drawStarEvaluation("ave", gon.total_average);
  // drawStarEvaluation("cleanliness", );
  for (var idx=0; idx<5; idx++) {
    drawStarEvaluation(gon.evaluation_columns[idx], gon.averages[idx]);
  }
  console.log(gon.evaluation_columns);

  var ctx = document.getElementById("myChart");
  var myChart = new Chart(ctx, {
    type: 'radar',
    data: {
      // labels: gon.evaluation_columns,
      labels: ["清潔感", "広さ", "高級感", "人の出入り", "プライバシー保護"],
      datasets: [{
        label: 'トイレ評価',
        backgroundColor: "rgba(124,192,235,0.6)",
        borderColor: "rgba(124,192,235,1)",
        data: gon.averages
      }]
    },
    options: {
      legend: {
        display: false
      },
      scale: {
        gridLines: {
            lineWidth: [1, 1, 1, 1, 1]
        },
        ticks: {
          min: 0,
          max: 5,
          stepSize: 1,
          display: false                             
        }
      }
    }
  });
</script>